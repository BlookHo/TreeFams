
-#%p
-#  @tree_arr: #{@tree_arr.inspect}
%p
  Connected Users Search:
%p
  who_found_user_id = @current_user.id: #{@current_user_id.inspect}
%p
  where_found_user_id = @user_id: #{@user_id.inspect}
%p
  @connected_users_arr: #{@connected_users_arr.inspect}

-#%p
-#  @tree_of_user: #{@tree_of_user.inspect}
-#%p
-#  @check_tree_arr: #{@check_tree_arr.inspect}
%p
  @len_check_tree: #{@len_check_tree.inspect}
%p
  @new_tree_arr: #{@new_tree_arr.inspect}
%p
  @new_tree_arr Length: #{@new_tree_arr_length.inspect}

-#%p
-#  BK_массив: @bk_arr: #{@bk_arr.inspect}
-#%p
-#  @circle: #{@circle.inspect}
-#%p
-#  @circle_hash: #{@circle_hash.inspect}
-#%p
-#  @circle_hash_mothers: #{@circle_hash_mothers.inspect}
-#
-#%h4
-#  Найдено #{@amount_of_profiles.inspect} совпадений профилей родных, в том числе #{@count.inspect} зарегистрированных пользователей.
-#%h4
-#  Их user_id: #{@users_ids_arr.inspect}
-#%p
-#  @relation_id_searched_arr: #{@relation_id_searched_arr.inspect}
-#%p
-#  @from_profile_searching: #{@from_profile_searching.inspect}
-#%p
-#  @profile_searched: #{@profile_searched.inspect}
-#%p
-#  @relation_searched: #{@relation_searched.inspect}
-#%p
-#  @all_profile_rows: #{@all_profile_rows.inspect}
-#%p
-#  @all_profile_rows_len: #{@all_profile_rows_len.inspect}
-#%p
-#  @relation_match_arr: #{@relation_match_arr.inspect}
-#%p
-#  @relation_match_size: #{@relation_match_size.inspect}
-#
-#%p
-#  @found_trees_hash: #{@found_trees_hash.inspect}
-#%p
-#  @found_trees_keys_arr: #{@found_trees_keys_arr.inspect}
-#%p
-#  @found_trees_values_arr: #{@found_trees_values_arr.inspect}
-#
-#%p
-#  @found_profiles_hash: #{@found_profiles_hash.inspect}
-#%p
-#  @found_profiles_values_arr: #{@found_profiles_values_arr.inspect}
-#%p
-#  @wide_found_profiles_hash: #{@wide_found_profiles_hash.inspect}
-#%p
-#  @wide_found_relations_hash: #{@wide_found_relations_hash.inspect}
-#
-#
-#%p
-#  @found_profiles_hash: #{@found_profiles_hash.inspect}
-#%p
-#  @found_relations_hash: #{@found_relations_hash.inspect}
-#
-#%p
-#  @all_match_profiles_arr: #{@all_match_profiles_arr.inspect}
-#%p
-#  @all_match_relations_arr: #{@all_match_relations_arr.inspect}
-#
-#%p
-#  @all_wide_match_profiles_arr: #{@all_wide_match_profiles_arr.inspect}
-#%p
-#  @all_wide_match_hash: #{@all_wide_match_hash.inspect}
-#%p
-#  @all_wide_match_relations_arr: #{@all_wide_match_relations_arr.inspect}

-#%h4
-#  ВСЕ СОВПАДЕНИЯ РОДНЫХ: {дерево  профили}@all_match_arr_sorted: #{@all_match_arr_sorted.inspect}
-#%h4
-#  ПОЛНЫЙ ХЭШ ПРОФИЛЕЙ: {дерево  профили}@all_wide_match_arr_sorted: #{@all_wide_match_arr_sorted.inspect}

%h4
  ВСЕ wide СОВПАДЕНИЯ РОДНЫХ : @final_reduced_profiles_hash: #{@final_reduced_profiles_hash.inspect}

-#%p
-#  НОМЕРА ДЕРЕВЬЕВ (АВТОРОВ) @user_ids_arr: #{@user_ids_arr.inspect}

-# %p
-#   ВСЕ НАЙДЕННЫЕ НОМЕРА wide ДЕРЕВЬЕВ (АВТОРОВ) @wide_user_ids_arr: #{@wide_user_ids_arr.inspect}
-#
-# %h4
-#   ВСЕ НАЙДЕННЫЕ ПРОФИЛИ: @wide_profile_ids_arr: #{@wide_profile_ids_arr.inspect}
-#
-# %h4
-#   @wide_amount_of_profiles: #{@wide_amount_of_profiles.inspect}
-#%h4
-#  @complete_hash: #{@complete_hash.inspect}
-#
-#
-#%p
-#  НОМЕРА ОТНОШЕНИЙ @all_match_relations_sorted: #{@all_match_relations_sorted.inspect}
-#%p
-#  НОМЕРА wide ОТНОШЕНИЙ @all_wide_match_relations_sorted: #{@all_wide_match_relations_sorted.inspect}

%h4
  ВСЕ wide НАЙДЕННЫЕ НОМЕРА ОТНОШЕНИй: @final_reduced_relations_hash: #{@final_reduced_relations_hash.inspect}

%p
  @elapsed_search_time: #{@elapsed_search_time.inspect}
-#
-#
-#
-#
-#%p
-#  make_search_results_paths ###########
%p
  @search_path_hash: #{@search_path_hash.inspect}




-#%p
-#  make_questions in NON-STANDARD CASE ###########
-#%p
-#  Добавляем к кому: @relation_add_to: #{@relation_add_to.inspect}
-#%p
-#  Добавляем кого: @relation_added: #{@relation_added.inspect}
-#%p
-#  С именем: @name_id: #{@name_id.inspect}
-#
-#%p
-#  @non_standard_questions_hash: #{@non_standard_questions_hash.inspect}


-#%p
-#  circle_hash_reduction in NON-STANDARD CASE ###########
-#%p
-#  @fathers_hash: #{@fathers_hash.inspect}
-#%p
-#  @mothers_hash: #{@mothers_hash.inspect}
-#%p
-#  @brothers_hash: #{@brothers_hash.inspect}
-#%p
-#  @sisters_hash: #{@sisters_hash.inspect}
-#%p
-#  @wives_hash: #{@wives_hash.inspect}
-#%p
-#  @husbands_hash: #{@husbands_hash.inspect}
-#%p
-#  @sons_hash: #{@sons_hash.inspect}
-#%p
-#  @daughters_hash: #{@daughters_hash.inspect}
-#
-#%p
-#  @non_standard_answers_hash: #{@non_standard_answers_hash.inspect}
-#%p
-#  @one_array_of_hashes: #{@one_array_of_hashes.inspect}
-#%p
-#  @reduced_hash: #{@reduced_hash.inspect}
-#%p
-#  @reduced_fathers_hash: #{@reduced_fathers_hash.inspect}
-#%p
-#  @reduced_mothers_hash: #{@reduced_mothers_hash.inspect}
-#%p
-#  @reduced_brothers_hash: #{@reduced_brothers_hash.inspect}
-#%p
-#  @reduced_sisters_hash: #{@reduced_sisters_hash.inspect}
-#%p
-#  @reduced_wives_hash: #{@reduced_wives_hash.inspect}
-#%p
-#  @reduced_husbands_hash: #{@reduced_husbands_hash.inspect}
-#%p
-#  @reduced_sons_hash: #{@reduced_sons_hash.inspect}
-#%p
-#  @reduced_daughters_hash: #{@reduced_daughters_hash.inspect}



.content
  .circle-view
    .circle-path#current-circle-path= render 'circle_path'
    .current-circle#current-circle= render 'circle_table', circle: @circle


  %div{style: "margin-top:50px;"}
    - if @search_results.empty?
      %h1.yellow-title Совпадений не найдено
    - else
      %h1.yellow-title Результаты поиска ваших родных:


    #path-results
      - @path_search_results.each do |result|
        - user = result[:user]
        - paths = result[:paths]
        .path-result{id: "path-results-#{user.id}"}
          = link_to fa_icon("plus-square-o"), '#', onclick: "showSearchResluts(#{user.id}); return false;", class: "open-search-results-link"
          .user-info
            = image_tag 'profile-default.png', class: :avatar
            %h1= user.profile.full_name
            %h3
              Найдено
              = paths.size
              = Russian.p(paths.size, "совпадение", "совпадения", "совпадений")
          = link_to 'Объединиться', connection_of_trees_path(current_user_id: current_user.id, user_id_to_connect: user.id, matched_profiles: @final_reduced_profiles_hash, matched_relations: @final_reduced_relations_hash), class: :handshake
          .results{style: 'display:none;', id: "results-#{user.id}"}
            - paths.each do |path|
              - path_id = Digest::MD5.hexdigest(path.to_s)
              .path
                %ul.path-list.path-search-list
                  - path.each_with_index do |step, index|
                    %li
                      - if step[:relation] != 0
                        = sex_id_to_human(step[:prev_sex_id])
                        = relation_to_human(step[:relation])
                      = link_to step[:profile].to_name, "/search/circle_path/#{path_id}/#{user.id}/#{step[:profile].id},#{step[:relation]}", remote: true
                      - if (index + 1) == path.size
                        .span.whois
                          Вероятно, это
                          = relation_to_profile(@search_results_relations.find {|r| r[step[:profile].id] }.try(:[], step[:profile].id) )
                      - else
                        %span
                          = fa_icon('arrow-right')

                .search-path-table{id: "search-path-table-#{path_id}", style: 'display:none;'}
                  = render 'search_circle_path_table', circle: user.profile.circle(user.id), author: user, path_id: path_id

  -# - @search_results.each do |result|
  -#   .circle-view
  -#     - if result.author.class == User
  -#       .circle-path{id: "current-circle-path-#{result.author.id}"}
  -#         = render 'search_circle_path', author: result.author
  -#       .current-circle{id: "current-circle-#{result.author.id}"}
  -#         = render 'search_circle_table', circle: result.circle, author: result.author
  -#     - else
  -#       .circle-path{id: "current-circle-path-#{params[:tree_id]}"}
  -#         = render 'search_circle_path', author: result.author
  -#       .current-circle{id: "current-circle-#{params[:tree_id]}"}
  -#         = render 'search_circle_table', circle: result.circle, author: result.author




    = render 'users/login_list'
